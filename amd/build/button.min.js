function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("local_sitefeedback/button",["exports","core/ajax","core/str","core/templates","core/notification","core/modal_events","core/modal_factory"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=j(b);c=i(c);d=j(d);e=j(e);f=j(f);g=j(g);function h(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;h=function(){return a};return a}function i(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=h();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}function j(a){return a&&a.__esModule?a:{default:a}}var k={regions:{feedbacktext:"[data-region=\"feedbacktext\"]",emailaddress:"[data-region=\"emailaddress\"]",includescreenshot:"[data-region=\"includescreenshot\"]",like:"[data-region=\"like\"]",ajaxing:"[data-region=\"ajaxing\"]",form:"[data-region=\"form\"]"},actions:{like:"[data-action=\"like\"]",dislike:"[data-action=\"dislike\"]"},classes:{hidden:"d-none"}},l=function(a){var b=a[0],c=b.querySelector(k.regions.feedbacktext),d=b.querySelector(k.regions.emailaddress),e=b.querySelector(k.regions.includescreenshot),f=b.querySelector(k.regions.like);return{message:c.value,emailaddress:d.value,includescreenshot:e.value,like:f.value}},m=function(a,b){var c=a[0],d=c.querySelector(k.regions.ajaxing);if(b){d.classList.remove(k.classes.hidden)}else{d.classList.add(k.classes.hidden)}},n=function(a){var b=a[0],c=b.querySelector(k.actions.like),d=b.querySelector(k.actions.dislike),f=b.querySelector(k.regions.form);c.addEventListener("click",function(a){f.classList.remove(k.classes.hidden);b.classList.remove("hidesend");a.preventDefault()});d.addEventListener("click",function(a){f.classList.remove(k.classes.hidden);b.classList.remove("hidesend");a.preventDefault()})},o=function(a,b){var c=a[0].querySelector("form");return d.default.render("core/notification",{message:b,closebutton:!0,iswarning:!0}).then(function(a,b){d.default.prependNodeContents(c,a,b)})},p=function(a,b){var h="";c.get_strings([{key:"yourfeedback",component:"local_sitefeedback"},{key:"send",component:"core_message"}]).then(function(a){var c=a[0];h=a[1];return g.default.create({title:c,body:d.default.render("local_sitefeedback/feedbackform",{externallinks:JSON.parse(b)}),type:g.default.types.SAVE_CANCEL,large:!0})}).done(function(a){a.setSaveButtonText(h);var b=a.getRoot();n(b);b[0].classList.add("hidesend");b.on(f.default.save,function(c){m(b,!0);c.preventDefault();q(l(b)).then(function(c){if(c.success){a.destroy()}else{o(b,c.warning)}m(b,!1)})});b.on(f.default.hidden,function(){a.destroy()});a.show()}).catch(e.default.exception)},q=function(a){var c=b.default.call([{methodname:"local_sitefeedback_sendmessage",args:a}])[0].fail(e.default.exception);return c};a.init=function init(a){var b=a.getAttribute("data-externallinks");a.addEventListener("click",function(c){p(a,b);c.preventDefault()});a.classList.add("js-enabled")}});
//# sourceMappingURL=button.min.js.map
